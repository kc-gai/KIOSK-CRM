'use client'

import { createContext, useContext, useState, useEffect, ReactNode } from 'react'

export type Locale = 'ja' | 'ko'

// All translations
export const translations = {
  ja: {
    // Sidebar
    dashboard: 'ダッシュボード',
    analysis: '現況分析',
    strategy: '戦略方向性',
    actions: 'アクション管理',
    kpi: 'KPI統計',
    pipedrive: 'Pipedrive CRM',
    salesTracking: '営業進捗管理',
    contentOptimization: 'コンテンツ最適化',
    seoReport: 'SEO分析レポート',
    settings: '設定',
    analysisPeriod: '分析期間',

    // Sidebar - Marketing Menu
    inboundMarketing: 'インバウンド',
    contentStrategy: 'コンテンツ戦略',
    contentStrategyDesc: 'SEO・コンテンツ戦略立案',
    contentProduction: 'コンテンツ制作',
    contentProductionDesc: '新規コンテンツ企画・発行',
    contentOptimizationMenu: 'コンテンツ最適化',
    contentOptimizationMenuDesc: 'CTR改善・リライト',
    seoAnalysis: 'SEO分析',
    seoAnalysisDesc: '検索パフォーマンスレポート',
    outboundMarketing: 'アウトバウンド',
    analyticsMenu: 'アナリティクス',
    performanceStatus: 'パフォーマンス現況',
    performanceStatusDesc: 'GA4・GSCデータ分析',
    kpiTracking: 'KPIトラッキング',
    kpiTrackingDesc: '目標対実績追跡',
    devTasks: '開発スケジュール',
    devTasksDesc: '開発進行状況・チェックリスト',
    workLogs: '作業日誌',
    workLogsDesc: '開発作業レポート自動集計',

    // Header
    update: '更新',
    export: 'エクスポート',

    // Dashboard
    dashboardTitle: 'ダッシュボード',
    dashboardSubtitle: 'SEOパフォーマンス概要 - 3ヶ月間の分析結果',
    searchExposure: '検索露出',
    clicks: 'クリック数',
    ctr: 'CTR',
    avgPosition: '平均掲載順位',
    users: 'ユーザー数',
    pageviews: 'ページビュー',
    selectedStrategy: '選定戦略',
    vsLastPeriod: '前期比',
    deterioration: '悪化',
    ga4Report: 'GA4 リポート',
    ga4ReportDesc: '訪問者の行動分析（訪問数、ページ遷移、クリック、予約完了など）',
    gscReport: 'Search Console リポート',
    gscReportDesc: '検索データの分析（表示回数、クリック数、検索キーワード）',
    deviceDistribution: 'デバイス別分布',
    regionClicks: '地域別クリック（海外）',
    aiCitationScore: 'AI引用スコア',
    notMonitored: 'モニタリング未実施',

    // Content Optimization
    contentOptTitle: 'コンテンツ最適化',
    contentOptSubtitle: 'AI時代のCTR改善とコンテンツ構造最適化',
    tabAiImpact: 'AI影響分析',
    tabRewriteManage: 'リライト管理',
    tabStructureGuide: '構造ガイド',
    highImprLowCtr: '高表示・低CTR記事',
    aiImpactDesc: 'AI検索に回答を取られている可能性が高い記事',
    rewriteTarget: 'リライト対象',
    addArticle: '記事追加',
    articleTitle: '記事タイトル',
    articleUrl: '記事URL',
    initialCtr: '開始CTR',
    currentCtr: '現在CTR',
    ctrChange: 'CTR変化',
    rewriteStatus: 'ステータス',
    notStartedStatus: '未着手',
    inProgressStatus: '進行中',
    completedStatus: '完了',
    changes: '変更内容',
    structureGuideTitle: '2段コンテンツ設計ガイド',
    aiCitationSection: 'AI引用用セクション',
    clickDriveSection: 'クリック誘導セクション',
    faqFormat: 'FAQ形式の導入',
    schemaMarkup: '構造化データ（Schema）',
    clearDefinition: '明確な定義文',
    featuredSnippet: 'Featured Snippet狙い',
    exclusiveInsight: '独占インサイト・データ',
    downloadMaterial: 'ダウンロード資料',
    calculator: '計算機・シミュレーター',
    caseStudy: '事例研究・インタビュー',
    lookerPlaceholder: 'Looker Studio埋め込みエリア',
    lookerHint2: '高表示+低CTR記事のフィルタリングビューを設定してください',
    save: '保存',
    saved: '保存完了',
    loading: '読み込み中...',
    add: '追加',
    keyword: 'キーワード',
    delete: '削除',

    // KPI Page
    kpiTitle: 'KPI統計指標',
    kpiSubtitle: '目標と実績の追跡・分析',
    basePeriod: '基準',
    monthlyTrend: '月別トレンド推移',
    searchPerformanceKpi: '検索パフォーマンスKPI',
    keywordKpi: '重点キーワードKPI',
    regionKpi: '地域別KPI',
    aiKpi: 'AI引用KPI',
    conversionKpi: 'コンバージョンKPI',
    metric: '指標',
    current: '現状',
    q1Target: 'Q1目標',
    q4Target: 'Q4目標',
    status: '状態',
    impressions: '表示回数',
    position: '順位',
    selectPeriod: '期間選択',
    realTimeData: 'Looker Studioからリアルタイムデータ取得',

    // Strategy Page
    strategyTitle: '戦略方向性',
    strategySubtitle: '選定戦略',
    strategyA: '方向性 A',
    strategyADesc: 'CTR改善 + 既存の強み最大化',
    strategyB: '方向性 B',
    strategyBDesc: 'インバウンド特化 + チェックイン機販売',
    strategyAEO: 'AEO/GEO',
    strategyAEODesc: 'AI検索時代への対応',
    linkedProduct: '連携商品',
    seasonPlan: 'シーズン先行計画（2ヶ月前公開原則）',
    targetSeason: '対象シーズン',
    publishTiming: 'コンテンツ公開',
    inProgress: '進行中',
    inProduction: '制作中',
    planned: '計画中',
    quarterlyTheme: '四半期別重点テーマ',
    dataInsights: '3ヶ月データからの戦略修正ポイント',

    // Actions Page
    actionsTitle: 'アクション管理',
    actionsSubtitle: '実行タスクの進捗管理',
    contentOptimizationSub: 'コンテンツ最適化',
    contentOptimizationSubDesc: '既存コンテンツのリライト',
    contentPublishing: 'コンテンツ発行',
    contentPublishingDesc: '新規コンテンツ制作',
    coldEmail: 'コールドメール',
    coldEmailDesc: '地域別メール送信管理',
    coldEmailTitle: 'コールドメール管理',
    coldEmailSubtitle: '地域別メール送信・問い合わせフォーム実績',
    emailSending: 'メール送信',
    inquiryForm: '問合せフォーム',
    totalOutreach: '合計アウトリーチ',
    regionBreakdown: '地域別内訳',
    monthlyTotal: '月間合計',
    addRecord: '実績追加',
    noDataThisMonth: '今月のデータはありません',
    monthlyPublishStats: '月別発行統計',
    publishedCount: '発行数',
    totalPublished: '累計発行',
    newTask: '新規タスク',
    allTasks: '全タスク',
    notStarted: '未着手',
    progressRate: '進捗率',
    all: 'すべて',
    blocked: 'ブロック',
    edit: '編集',
    priorityHigh: '最優先',
    priorityMedium: '高',
    priorityLow: '中',
    priorityReview: '検討',

    // Settings Page
    settingsTitle: '設定',
    settingsSubtitle: 'ダッシュボードの設定を管理',
    lookerStudioUrl: 'Looker Studio 埋め込みURL',
    ga4ReportUrl: 'GA4 レポート URL',
    gscReportUrl: 'Search Console レポート URL',
    lookerHint: 'Looker Studioで「埋め込み」→「URLをコピー」して貼り付けてください',
    periodSettings: '分析期間設定',
    startDate: '開始日',
    endDate: '終了日',
    notificationSettings: '通知設定',
    weeklyReminder: '週次レビューリマインダー（毎週月曜）',
    monthlyReminder: '月次レポート作成リマインダー',
    taskReminder: 'タスク期限リマインダー',
    database: 'データベース',
    localFile: 'ローカルファイル',
    backup: 'バックアップ',
    reset: 'リセット',
    quickLinks: 'クイックリンク',

    // Bulk Email
    bulkEmail: '一括メール送信',
    bulkEmailDesc: 'リストからメール一括送信',
    emailTemplate: 'メールテンプレート',
    selectRecipients: '送信先を選択',
    contactRound: '接触回数',
    round1: '1回目',
    round2: '2回目',
    round3: '3回目',
    round4: '4回目',
    round5: '5回目以上',
    sendEmail: 'メール送信',
    sendAll: '一括送信',
    emailHistory: '送信履歴',
    emailDashboard: 'メールダッシュボード',
    dailyLimitLabel: '1日送信上限',
    sendInterval: '送信間隔',
    spamPrevention: 'スパム防止',
    templatePreview: 'テンプレートプレビュー',
    variableGuide: '変数ガイド',
    sendingEmail: '送信中...',
    sendComplete: '送信完了',
    sendFailed: '送信失敗',
    blacklistLabel: 'ブラックリスト',
    addToBlacklist: 'ブラックリストに追加',
    removeFromBlacklist: 'ブラックリストから解除',
    bounced: 'バウンス',
    followUp: 'フォローアップ',
    followUpNeeded: 'フォローアップ必要',
    daysAgo: '日前に送信',
    remainingToday: '本日残り送信可能',
    estimatedTime: '予想所要時間',
    emailSettings: 'メール設定',
    senderEmail: '送信者メール',
    senderName: '送信者名',
    batchSize: 'バッチサイズ',
    batchInterval: 'バッチ間隔',
    followUpDays: 'フォローアップ日数',
    selectedCompanies: '選択済み企業',
    noEmail: 'メールなし',
    emailOnly: 'メール有りのみ',
    selectAll: '全選択',
    deselectAll: '選択解除',
    confirmSend: '送信確認',
    confirmSendMessage: '以下の内容で一括送信してよろしいですか？',
    sending: '送信処理中',
    sendResult: '送信結果',
    sent: '送信成功',
    failed: '失敗',
    blacklisted: 'ブラックリスト除外',
    noTemplate: 'テンプレートなし',
    templateSettings: 'テンプレート設定',
    mailSubject: '件名',
    mailBody: '本文',
    reason: '理由',
    blockedDate: 'ブロック日',
    seconds: '秒',
    minutes: '分',
    companies: '社',
    emails: '通',
    saveSettings: '設定を保存',
    saving: '保存中...',
    templateName: 'テンプレート名',
    editTemplate: 'テンプレート編集',
    resetTemplates: 'テンプレート初期化',
    resetConfirm: 'テンプレートを初期値に戻しますか？',
    senderSettings: '発信者設定',
    sendSettings: '送信設定',
    cancel: 'キャンセル',
  },
  ko: {
    // Sidebar
    dashboard: '대시보드',
    analysis: '현황분석',
    strategy: '전략방향성',
    actions: '액션관리',
    kpi: 'KPI통계',
    pipedrive: 'Pipedrive CRM',
    salesTracking: '영업 진척 관리',
    contentOptimization: '콘텐츠 최적화',
    seoReport: 'SEO분석리포트',
    settings: '설정',
    analysisPeriod: '분석기간',

    // Sidebar - Marketing Menu
    inboundMarketing: '인바운드',
    contentStrategy: '콘텐츠 전략',
    contentStrategyDesc: 'SEO·콘텐츠 전략 수립',
    contentProduction: '콘텐츠 제작',
    contentProductionDesc: '신규 콘텐츠 기획·발행',
    contentOptimizationMenu: '콘텐츠 최적화',
    contentOptimizationMenuDesc: 'CTR 개선·리라이팅',
    seoAnalysis: 'SEO 분석',
    seoAnalysisDesc: '검색 성과 리포트',
    outboundMarketing: '아웃바운드',
    analyticsMenu: '애널리틱스',
    performanceStatus: '퍼포먼스 현황',
    performanceStatusDesc: 'GA4·GSC 데이터 분석',
    kpiTracking: 'KPI 트래킹',
    kpiTrackingDesc: '목표 대비 실적 추적',
    devTasks: '개발 스케줄',
    devTasksDesc: '개발 진행 현황·체크리스트',
    workLogs: '작업 일지',
    workLogsDesc: '개발 작업 리포트 자동 집계',

    // Header
    update: '새로고침',
    export: '내보내기',

    // Dashboard
    dashboardTitle: '대시보드',
    dashboardSubtitle: 'SEO 퍼포먼스 개요 - 3개월간 분석결과',
    searchExposure: '검색노출',
    clicks: '클릭수',
    ctr: 'CTR',
    avgPosition: '평균게재순위',
    users: '사용자수',
    pageviews: '페이지뷰',
    selectedStrategy: '선정전략',
    vsLastPeriod: '전기대비',
    deterioration: '악화',
    ga4Report: 'GA4 리포트',
    ga4ReportDesc: '방문자 행동분석 (방문수, 페이지이동, 클릭, 예약완료 등)',
    gscReport: 'Search Console 리포트',
    gscReportDesc: '검색데이터 분석 (노출회수, 클릭수, 검색 키워드)',
    deviceDistribution: '디바이스별 분포',
    regionClicks: '지역별 클릭 (해외)',
    aiCitationScore: 'AI인용스코어',
    notMonitored: '모니터링 미실시',

    // Content Optimization
    contentOptTitle: '콘텐츠 최적화',
    contentOptSubtitle: 'AI 시대의 CTR 개선과 콘텐츠 구조 최적화',
    tabAiImpact: 'AI 영향 분석',
    tabRewriteManage: '리라이팅 관리',
    tabStructureGuide: '구조 가이드',
    highImprLowCtr: '고노출·저CTR 기사',
    aiImpactDesc: 'AI 검색에 답변을 빼앗긴 가능성이 높은 기사',
    rewriteTarget: '리라이팅 대상',
    addArticle: '기사 추가',
    articleTitle: '기사 제목',
    articleUrl: '기사 URL',
    initialCtr: '시작 CTR',
    currentCtr: '현재 CTR',
    ctrChange: 'CTR 변화',
    rewriteStatus: '상태',
    notStartedStatus: '미착수',
    inProgressStatus: '진행중',
    completedStatus: '완료',
    changes: '변경 내용',
    structureGuideTitle: '2단 콘텐츠 설계 가이드',
    aiCitationSection: 'AI 인용용 섹션',
    clickDriveSection: '클릭 유도 섹션',
    faqFormat: 'FAQ 형식 도입',
    schemaMarkup: '구조화 데이터(Schema)',
    clearDefinition: '명확한 정의문',
    featuredSnippet: 'Featured Snippet 노리기',
    exclusiveInsight: '독점 인사이트·데이터',
    downloadMaterial: '다운로드 자료',
    calculator: '계산기·시뮬레이터',
    caseStudy: '사례 연구·인터뷰',
    lookerPlaceholder: 'Looker Studio 임베드 영역',
    lookerHint2: '고노출+저CTR 기사 필터링 뷰를 설정하세요',
    save: '저장',
    saved: '저장완료',
    loading: '로딩중...',
    add: '추가',
    keyword: '키워드',
    delete: '삭제',

    // KPI Page
    kpiTitle: 'KPI 통계지표',
    kpiSubtitle: '목표와 실적 추적·분석',
    basePeriod: '기준',
    monthlyTrend: '월별 트렌드 추이',
    searchPerformanceKpi: '검색 퍼포먼스 KPI',
    keywordKpi: '중점 키워드 KPI',
    regionKpi: '지역별 KPI',
    aiKpi: 'AI 인용 KPI',
    conversionKpi: '전환 KPI',
    metric: '지표',
    current: '현황',
    q1Target: 'Q1목표',
    q4Target: 'Q4목표',
    status: '상태',
    impressions: '노출수',
    position: '순위',
    selectPeriod: '기간 선택',
    realTimeData: 'Looker Studio에서 실시간 데이터 취득',

    // Strategy Page
    strategyTitle: '전략 방향성',
    strategySubtitle: '선정 전략',
    strategyA: '방향성 A',
    strategyADesc: 'CTR 개선 + 기존 강점 최대화',
    strategyB: '방향성 B',
    strategyBDesc: '인바운드 특화 + 체크인 기기 판매',
    strategyAEO: 'AEO/GEO',
    strategyAEODesc: 'AI 검색 시대 대응',
    linkedProduct: '연계 상품',
    seasonPlan: '시즌 선행 계획 (2개월 전 공개 원칙)',
    targetSeason: '대상 시즌',
    publishTiming: '콘텐츠 공개',
    inProgress: '진행중',
    inProduction: '제작중',
    planned: '계획중',
    quarterlyTheme: '분기별 중점 테마',
    dataInsights: '3개월 데이터 기반 전략 수정 포인트',

    // Actions Page
    actionsTitle: '액션 관리',
    actionsSubtitle: '실행 태스크 진행 관리',
    contentOptimizationSub: '콘텐츠 최적화',
    contentOptimizationSubDesc: '기존 콘텐츠 리라이팅',
    contentPublishing: '콘텐츠 발행',
    contentPublishingDesc: '신규 콘텐츠 제작',
    coldEmail: '콜드메일',
    coldEmailDesc: '지역별 메일 발송 관리',
    coldEmailTitle: '콜드메일 관리',
    coldEmailSubtitle: '지역별 메일 발송·문의 양식 실적',
    emailSending: '메일 발송',
    inquiryForm: '문의 양식',
    totalOutreach: '총 아웃리치',
    regionBreakdown: '지역별 내역',
    monthlyTotal: '월간 합계',
    addRecord: '실적 추가',
    noDataThisMonth: '이번 달 데이터가 없습니다',
    monthlyPublishStats: '월별 발행 통계',
    publishedCount: '발행 수',
    totalPublished: '누적 발행',
    newTask: '새 태스크',
    allTasks: '전체 태스크',
    notStarted: '미착수',
    progressRate: '진행률',
    all: '전체',
    blocked: '차단됨',
    edit: '편집',
    priorityHigh: '최우선',
    priorityMedium: '높음',
    priorityLow: '보통',
    priorityReview: '검토',

    // Settings Page
    settingsTitle: '설정',
    settingsSubtitle: '대시보드 설정 관리',
    lookerStudioUrl: 'Looker Studio 임베드 URL',
    ga4ReportUrl: 'GA4 리포트 URL',
    gscReportUrl: 'Search Console 리포트 URL',
    lookerHint: 'Looker Studio에서 "삽입"→"URL 복사"하여 붙여넣기 하세요',
    periodSettings: '분석 기간 설정',
    startDate: '시작일',
    endDate: '종료일',
    notificationSettings: '알림 설정',
    weeklyReminder: '주간 리뷰 리마인더 (매주 월요일)',
    monthlyReminder: '월간 리포트 작성 리마인더',
    taskReminder: '태스크 마감 리마인더',
    database: '데이터베이스',
    localFile: '로컬 파일',
    backup: '백업',
    reset: '리셋',
    quickLinks: '퀵 링크',

    // Bulk Email
    bulkEmail: '일괄 메일 발송',
    bulkEmailDesc: '리스트에서 메일 일괄 발송',
    emailTemplate: '메일 템플릿',
    selectRecipients: '수신자 선택',
    contactRound: '연락 회차',
    round1: '1회차',
    round2: '2회차',
    round3: '3회차',
    round4: '4회차',
    round5: '5회차 이상',
    sendEmail: '메일 발송',
    sendAll: '일괄 발송',
    emailHistory: '발송 이력',
    emailDashboard: '발송 대시보드',
    dailyLimitLabel: '일일 발송 한도',
    sendInterval: '발송 간격',
    spamPrevention: '스팸 방지',
    templatePreview: '템플릿 미리보기',
    variableGuide: '변수 가이드',
    sendingEmail: '발송 중...',
    sendComplete: '발송 완료',
    sendFailed: '발송 실패',
    blacklistLabel: '블랙리스트',
    addToBlacklist: '블랙리스트 추가',
    removeFromBlacklist: '블랙리스트 해제',
    bounced: '바운스',
    followUp: '팔로업',
    followUpNeeded: '팔로업 필요',
    daysAgo: '일 전 발송',
    remainingToday: '오늘 잔여 발송 가능',
    estimatedTime: '예상 소요시간',
    emailSettings: '메일 설정',
    senderEmail: '발신자 이메일',
    senderName: '발신자 이름',
    batchSize: '배치 사이즈',
    batchInterval: '배치 간격',
    followUpDays: '팔로업 일수',
    selectedCompanies: '선택된 업체',
    noEmail: '이메일 없음',
    emailOnly: '이메일 있는 업체만',
    selectAll: '전체 선택',
    deselectAll: '선택 해제',
    confirmSend: '발송 확인',
    confirmSendMessage: '아래 내용으로 일괄 발송하시겠습니까?',
    sending: '발송 처리 중',
    sendResult: '발송 결과',
    sent: '발송 성공',
    failed: '실패',
    blacklisted: '블랙리스트 제외',
    noTemplate: '템플릿 없음',
    templateSettings: '템플릿 설정',
    mailSubject: '제목',
    mailBody: '본문',
    reason: '사유',
    blockedDate: '차단 일자',
    seconds: '초',
    minutes: '분',
    companies: '사',
    emails: '통',
    saveSettings: '설정 저장',
    saving: '저장 중...',
    templateName: '템플릿 이름',
    editTemplate: '템플릿 편집',
    resetTemplates: '템플릿 초기화',
    resetConfirm: '템플릿을 초기값으로 되돌리시겠습니까?',
    senderSettings: '발신자 설정',
    sendSettings: '발송 설정',
    cancel: '취소',
  },
}

type TranslationContextType = {
  locale: Locale
  setLocale: (locale: Locale) => void
  t: typeof translations['ja']
}

const TranslationContext = createContext<TranslationContextType | null>(null)

export function TranslationProvider({ children }: { children: ReactNode }) {
  const [locale, setLocaleState] = useState<Locale>('ja')

  useEffect(() => {
    const saved = localStorage.getItem('locale') as Locale
    if (saved && (saved === 'ja' || saved === 'ko')) {
      setLocaleState(saved)
    }

    // Listen for locale changes from Header
    const handleLocaleChange = (e: CustomEvent<Locale>) => {
      setLocaleState(e.detail)
    }

    window.addEventListener('localeChange', handleLocaleChange as EventListener)
    return () => {
      window.removeEventListener('localeChange', handleLocaleChange as EventListener)
    }
  }, [])

  const setLocale = (newLocale: Locale) => {
    setLocaleState(newLocale)
    localStorage.setItem('locale', newLocale)
  }

  return (
    <TranslationContext.Provider value={{ locale, setLocale, t: translations[locale] }}>
      {children}
    </TranslationContext.Provider>
  )
}

export function useTranslation() {
  const context = useContext(TranslationContext)
  if (!context) {
    throw new Error('useTranslation must be used within TranslationProvider')
  }
  return context
}
